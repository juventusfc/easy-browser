# 布局-渲染-合成-绘制

## 排版布局(Layout)

浏览器生成 DOM Tree 和 CSSOM Tree 后，生成 Render Tress。在此之后，浏览器开始确定每一个元素的位置，也就是布局。

### 正常流排版

浏览器最基本的排版方案是“正常流排版”。浏览器支持**元素**和**文字**的混排，元素被定义为占据长方形的区域，还允许边框、边距和留白，这个就是所谓的**盒模型**。

在正常流排版基础上，还支持：

- 绝对定位元素
  绝对定位元素把自身从正常流抽出，直接由 top 和 left 等属性确定自身的位置，不参加排版计算，也不影响其它元素。绝对定位元素由 position:absolute 控制。
- 浮动元素
  浮动元素则是使得自己在正常流的位置向左或者向右移动到边界，并且占据一块排版空间。浮动元素由 float 属性控制。

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
  </head>
  <body>
    <h1 style="color:red">元素(盒模型)排版</h1>
    文字排版
    <div style="display: inline;">元素变为文字排版</div>
  </body>
</html>
```

#### 正常流文字排版

文字不能通过 Dev Tool 的 Inspect 去获得，也没有样式，由浏览器自行决定展示的样子。

正常流文字排版时，浏览器会从某个字体文件中获取文字的信息。

display 值为 inline 的元素中的文字排版时，会参照文字排版。

#### 正常流元素(盒模型)排版

在正常流中，display 不为 inline 的元素或者伪元素，会以盒的形式跟文字一起排版。多数 display 属性都可以分成两部分：内部的排版和是否 inline，带有 inline- 前缀的盒，被称作行内级盒。

### Flex 排版

Flex 排版由外部元素的 display 属性控制。

## 渲染(Render)

渲染指的是将元素模型变成位图的过程。

位图就是在内存中建立一张二位表格，将一张图片的每个像素对应的颜色保存进去。

浏览器中渲染这个过程，就是把每一个元素对应的盒变成位图。这里的元素包括 HTML 元素和伪元素，一个元素可能对应多个盒（比如 inline 元素，可能会分成多行）。每一个盒对应着一张位图。

## 合成(Composing)

合成不是浏览器的必须过程。渲染过程不会把子元素渲染到位图上面，合成的作用，就是为一些元素创造“合成后的位图”，把一部分子元素渲染到合成的位图上。

## 绘制

绘制是把位图最终绘制到屏幕上的过程。
